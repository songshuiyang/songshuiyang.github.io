<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>分布式-Zookeeper-分布式协调服务-简介 | 宋水阳个人博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="分布式,Zookeeper">
    <meta name="description" content="前言Zookeeper 是什么？ ZooKeeper 是一个开放源码的分布式协调服务，它是集群的管理者，监视着集群中各个节点的状态根据节点提交的反馈进行下一步合理操作。最终，将简单易用的接口和性能高效、功能稳定的系统提供给用户。   ZooKeeper 的由来 下面这段内容摘自《从Paxos到Zookeeper 》第四章第一节的某段内容，推荐大家阅读以下： Zookeeper最早起源于雅虎研究院的">
<meta name="keywords" content="分布式,Zookeeper">
<meta property="og:type" content="article">
<meta property="og:title" content="分布式-Zookeeper-分布式协调服务-简介">
<meta property="og:url" content="http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/index.html">
<meta property="og:site_name" content="宋水阳个人博客">
<meta property="og:description" content="前言Zookeeper 是什么？ ZooKeeper 是一个开放源码的分布式协调服务，它是集群的管理者，监视着集群中各个节点的状态根据节点提交的反馈进行下一步合理操作。最终，将简单易用的接口和性能高效、功能稳定的系统提供给用户。   ZooKeeper 的由来 下面这段内容摘自《从Paxos到Zookeeper 》第四章第一节的某段内容，推荐大家阅读以下： Zookeeper最早起源于雅虎研究院的">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2020-01-04T12:21:52.086Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分布式-Zookeeper-分布式协调服务-简介">
<meta name="twitter:description" content="前言Zookeeper 是什么？ ZooKeeper 是一个开放源码的分布式协调服务，它是集群的管理者，监视着集群中各个节点的状态根据节点提交的反馈进行下一步合理操作。最终，将简单易用的接口和性能高效、功能稳定的系统提供给用户。   ZooKeeper 的由来 下面这段内容摘自《从Paxos到Zookeeper 》第四章第一节的某段内容，推荐大家阅读以下： Zookeeper最早起源于雅虎研究院的">
    
        <link rel="alternate" type="application/atom+xml" title="宋水阳个人博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">songshuiyang</h5>
          <a href="mailto:songshuiyang@foxmail.com" title="songshuiyang@foxmail.com" class="mail">songshuiyang@foxmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/Java基础">
                <i class="icon icon-lg icon-bookmark"></i>
                Java基础
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/Java集合">
                <i class="icon icon-lg icon-camera"></i>
                Java集合
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/Java并发">
                <i class="icon icon-lg icon-fire"></i>
                Java并发
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/Io">
                <i class="icon icon-lg icon-film"></i>
                Java IO
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/JVM">
                <i class="icon icon-lg icon-gift"></i>
                JVM
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/Spring">
                <i class="icon icon-lg icon-money"></i>
                Spring
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/SpringMvc">
                <i class="icon icon-lg icon-bullhorn"></i>
                SpringMvc
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/SpringBoot">
                <i class="icon icon-lg icon-bolt"></i>
                SpringBoot
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/SpringCloud">
                <i class="icon icon-lg icon-cogs"></i>
                SpringCloud
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/Mybatis">
                <i class="icon icon-lg icon-tasks"></i>
                Mybatis
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/设计模式">
                <i class="icon icon-lg icon-calendar"></i>
                设计模式
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/数据库">
                <i class="icon icon-lg icon-compass"></i>
                数据库
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/缓存">
                <i class="icon icon-lg icon-comment"></i>
                缓存
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/消息队列">
                <i class="icon icon-lg icon-coffee"></i>
                消息队列
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/分布式">
                <i class="icon icon-lg icon-code"></i>
                分布式
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/计算机网络">
                <i class="icon icon-lg icon-umbrella"></i>
                计算机网络
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/数据结构">
                <i class="icon icon-lg icon-spinner"></i>
                数据结构
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/Linux">
                <i class="icon icon-lg icon-magic"></i>
                Linux
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/前端">
                <i class="icon icon-lg icon-twitter"></i>
                前端
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/笔记">
                <i class="icon icon-lg icon-bell"></i>
                笔记
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/开发工具">
                <i class="icon icon-lg icon-strikethrough"></i>
                开发工具
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/业务">
                <i class="icon icon-lg icon-pinterest"></i>
                业务
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/songshuiyang" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ac93934d9b847216e10a2f133187e535";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
<header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">分布式-Zookeeper-分布式协调服务-简介</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">分布式-Zookeeper-分布式协调服务-简介</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-03-01T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2018-03-02
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分布式/">分布式</a></li></ul>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Zookeeper-是什么？"><span class="post-toc-number">1.0.1.</span> <span class="post-toc-text">Zookeeper 是什么？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#特性"><span class="post-toc-number">1.0.2.</span> <span class="post-toc-text">特性</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Zookeeper-的设计目标"><span class="post-toc-number">1.0.3.</span> <span class="post-toc-text">Zookeeper 的设计目标</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#应用场景"><span class="post-toc-number">1.0.4.</span> <span class="post-toc-text">应用场景</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Zookeeper-对于读写请求有所不同："><span class="post-toc-number">1.0.5.</span> <span class="post-toc-text">Zookeeper 对于读写请求有所不同：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Zookeeper-提供了什么"><span class="post-toc-number">1.0.6.</span> <span class="post-toc-text">Zookeeper 提供了什么</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ZooKeeper-性能"><span class="post-toc-number">1.0.7.</span> <span class="post-toc-text">ZooKeeper 性能</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Zookeeper-节点类型"><span class="post-toc-number">1.0.8.</span> <span class="post-toc-text">Zookeeper 节点类型</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Zookeeper是如何保证事务的顺序一致性的"><span class="post-toc-number">1.0.9.</span> <span class="post-toc-text">Zookeeper是如何保证事务的顺序一致性的</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Zookeeper-的-Java-客户端都有哪些？"><span class="post-toc-number">1.0.10.</span> <span class="post-toc-text">Zookeeper 的 Java 客户端都有哪些？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#客户端监控软件ZooInspector"><span class="post-toc-number">1.0.11.</span> <span class="post-toc-text">客户端监控软件ZooInspector</span></a></li></ol></li></ol><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#总结"><span class="post-toc-number">2.</span> <span class="post-toc-text">总结</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#参考"><span class="post-toc-number">3.</span> <span class="post-toc-text">参考</span></a></li>
        </nav>
    </aside>


<article id="post-backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">分布式-Zookeeper-分布式协调服务-简介</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-03-02 00:00:00" datetime="2018-03-01T16:00:00.000Z" itemprop="datePublished">2018-03-02</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分布式/">分布式</a></li></ul>



            

<span id="busuanzi_container_site_pv">
   <i class="icon icon-eye icon-pr"></i>本页总访问量<span id="busuanzi_value_page_pv"></span>次
</span>



        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h4 id="Zookeeper-是什么？"><a href="#Zookeeper-是什么？" class="headerlink" title="Zookeeper 是什么？"></a>Zookeeper 是什么？</h4><ul>
<li>ZooKeeper 是一个开放源码的分布式协调服务，它是集群的管理者，监视着集群中各个节点的状态根据节点提交的反馈进行下一步合理操作。最终，将简单易用的接口和性能高效、功能稳定的系统提供给用户。</li>
</ul>
<ul>
<li>ZooKeeper 的由来<ul>
<li>下面这段内容摘自《从Paxos到Zookeeper 》第四章第一节的某段内容，推荐大家阅读以下：</li>
<li>Zookeeper最早起源于雅虎研究院的一个研究小组。在当时，研究人员发现，在雅虎内部很多大型系统基本都需要依赖一个类似的系统来进行分布式协调，但是这些系统往往都存在分布式单点问题。所以，雅虎的开发人员就试图开发一个通用的无单点问题的分布式协调框架，以便让开发人员将精力集中在处理业务逻辑上。</li>
<li>关于“ZooKeeper”这个项目的名字，其实也有一段趣闻。在立项初期，考虑到之前内部很多项目都是使用动物的名字来命名的（例如著名的Pig项目),雅虎的工程师希望给这个项目也取一个动物的名字。时任研究院的首席科学家RaghuRamakrishnan开玩笑地说：“在这样下去，我们这儿就变成动物园了！”此话一出，大家纷纷表示就叫动物园管理员吧一一一因为各个以动物命名的分布式组件放在一起，雅虎的整个分布式系统看上去就像一个大型的动物园了，而Zookeeper正好要用来进行分布式环境的协调一一于是，Zookeeper的名字也就由此诞生了。</li>
</ul>
</li>
</ul>
<ul>
<li><p>官网：zookeeper.apache.org/</p>
</li>
<li><p>分布式应用程序可以基于 Zookeeper 实现诸如功能：</p>
<ul>
<li>数据发布/订阅</li>
<li>负载均衡</li>
<li>命名服务</li>
<li>分布式协调/通知</li>
<li>集群管理</li>
<li>Master 选举</li>
<li>分布式锁</li>
<li>分布式队列</li>
</ul>
</li>
</ul>
<h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><ul>
<li><p>顺序一致性(有序性)</p>
<ul>
<li>从同一个客户端发起的事务请求，最终将会严格地按照其发起顺序被应用到 Zookeeper 中去。</li>
<li>有序性是 Zookeeper 中非常重要的一个特性。</li>
<li>所有的更新都是全局有序的，每个更新都有一个唯一的时间戳，这个时间戳称为zxid(Zookeeper Transaction Id)。</li>
<li>而读请求只会相对于更新有序，也就是读请求的返回结果中会带有这个 Zookeeper 最新的 zxid 。</li>
</ul>
</li>
<li><p>原子性</p>
<ul>
<li>所有事务请求的处理结果在整个集群中所有机器上的应用情况是一致的，即整个集群要么都成功应用了某个事务，要么都没有应用。</li>
</ul>
</li>
<li><p>单一视图</p>
<ul>
<li>无论客户端连接的是哪个 Zookeeper 服务器，其看到的服务端数据模型都是一致的。</li>
</ul>
</li>
<li>可靠性<ul>
<li>一旦服务端成功地应用了一个事务，并完成对客户端的响应，那么该事务所引起的服务端状态变更将会一直被保留，除非有另一个事务对其进行了变更。</li>
</ul>
</li>
<li>实时性<ul>
<li>Zookeeper 保证在一定的时间段内，客户端最终一定能够从服务端上读取到最新的数据状态。 </li>
</ul>
</li>
</ul>
<h4 id="Zookeeper-的设计目标"><a href="#Zookeeper-的设计目标" class="headerlink" title="Zookeeper 的设计目标"></a>Zookeeper 的设计目标</h4><ul>
<li>1、简单的数据结构，Zookeeper 使得分布式程序能够通过一个共享的树形结构的名字空间来进行相互协调，即 Zookeeper 服务器内存中的数据模型由一系列被称为 ZNode 的数据节点组成，Zookeeper 将全量的数据存储在内存中，以此来提高服务器吞吐、减少延迟的目的。</li>
<li>2、可以构建集群 Zookeeper 集群通常由一组机器构成，组成 Zookeeper 集群的而每台机器都会在内存中维护当前服务器状态，并且每台机器之间都相互通信。</li>
<li>3、顺序访问，对于来自客户端的每个更新请求，Zookeeper 都会分配一个全局唯一的递增编号，这个编号反映了所有事务操作的先后顺序。</li>
<li>4、高性能，Zookeeper 和 Redis 一样全量数据存储在内存中，100%读请求压测 QPS 12-13W 。</li>
</ul>
<h4 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h4><ul>
<li>Zookeeper 的功能很强大，应用场景很多，结合我们实际工作中使用 Dubbo 框架的情况，Zookeeper 主要是做注册中心用。<ul>
<li>基于 Dubbo 框架开发的提供者、消费者都向 Zookeeper 注册自己的 URL ，消费者还能拿到并订阅提供者的注册 URL ，以便在后续程序的执行中去调用提供者。</li>
<li>而提供者发生了变动，也会通过 Zookeeper 向订阅的消费者发送通知。</li>
<li>Zookeeper支持集群部署，所以可以实现注册中心的高可用</li>
</ul>
</li>
<li><p>当然，Zookeeper 能提供的不仅仅如此，再例如：</p>
<ul>
<li>统一命名服务。<ul>
<li>命名服务是指通过指定的名字来获取资源或服务的地址，利用zk创建一个全局的路径，即时唯一的路径，这个路径就可以作为一个名字，指向集群中机器或者提供服务的地址，又或者一个远程的对象等。</li>
</ul>
</li>
<li>分布式锁服务。<ul>
<li>这个比较好理解，Zookeeper 实现的分布式锁的可靠性会比 Redis 实现的分布式锁高，当然相对来说，性能会低。</li>
<li>有了 ZooKeeper 的一致性文件系统，锁的问题变得容易。锁服务可以分成两类，一个是保持独占，另一个是控制时序。<ul>
<li>1、保持独占，我们把 znode 看作是一把锁，通过 createZnode 的方式来实现。所有客户端都去创建 /distribute_lock 节点，最终成功创建的那个客户端也即拥有了这把锁。用完删除掉自己创建的 /distribute_lock 节点就释放出锁。</li>
<li>2、控制时序，/distribute_lock 已经预先存在，所有客户端在它下面创建临时顺序编号目录节点，和 Master 一样，编号最小的获得锁，用完删除，依次方便。</li>
</ul>
</li>
</ul>
</li>
<li>配置管理。<ul>
<li>例如说，Spring Cloud Config Zookeeper ，就实现了基于 Zookeeper 的 Spring Cloud Config 的实现，提供配置中心的服务。</li>
</ul>
</li>
<li>注册与发现。<ul>
<li>是否有机器加入或退出</li>
<li>所有机器约定在父目录下创建临时目录节点，然后监听父目录节点下的子节点变化。一旦有机器挂掉，该机器与 ZooKeeper 的连接断开，其所创建的临时目录节点也被删除，所有其他机器都收到通知：某个节点被删除了。</li>
</ul>
</li>
<li>Master 选举。<ul>
<li>基于 Zookeeper 实现分布式协调，从而实现主从的选举。这个在 Kafka、Elastic-Job 等等中间件，都有所使用到。</li>
</ul>
</li>
<li>队列管理<ul>
<li>1、同步队列，当一个队列的成员都聚齐时，这个队列才可用，否则一直等待。在约定的目录下创建临时目录节点，监听节点数目是否是我们要求的数目。</li>
<li>2、队列按照 FIFO 方式进行入队和出队操作。和分布式锁服务中的控制时序的场景基本原理一致，入列有编号，出列按编号。创建 PERSISTENT_SEQUENTIAL 节点，创建成功时 Watcher 通知等待的队列，队列删除序列号最小的节点以消费。此场景下，znode 用于消息存储，znode 存储的数据就是消息队列中的消息内容，SEQUENTIAL 序列号就是消息的编号，按序取出即可。由于创建的节点是持久化的，所以不必担心队列消息丢失的问题。<h4 id="Zookeeper-对于读写请求有所不同："><a href="#Zookeeper-对于读写请求有所不同：" class="headerlink" title="Zookeeper 对于读写请求有所不同："></a>Zookeeper 对于读写请求有所不同：</h4></li>
</ul>
</li>
</ul>
</li>
<li><p>客户端的读请求可以被集群中的任意一台机器处理，如果读请求在节点上注册了监听器，这个监听器也是由所连接的 Zookeeper 机器来处理。</p>
</li>
<li>对于写请求，这些请求会同时发给其他 Zookeeper 机器并且达成一致后，请求才会返回成功（保证一致性）。因此，随着 Zookeeper 的集群机器增多，读请求的吞吐会提高但是写请求的吞吐会下降。</li>
</ul>
<h4 id="Zookeeper-提供了什么"><a href="#Zookeeper-提供了什么" class="headerlink" title="Zookeeper 提供了什么"></a>Zookeeper 提供了什么</h4><ul>
<li>1、文件系统。<ul>
<li>Zookeeper 提供一个多层级的节点命名空间(节点称为 znode)。与文件系统不同的是，这些节点都可以设置关联的数据，而文件系统中只有文件节点可以存放数据而目录节点不行。</li>
<li>Zookeeper 为了保证高吞吐和低延迟，在内存中维护了这个树状的目录结构，这种特性使得 Zookeeper 不能用于存放大量的数据，每个节点的存放数据上限为 1M </li>
</ul>
</li>
<li>2、通知机制。<ul>
<li></li>
</ul>
</li>
</ul>
<h4 id="ZooKeeper-性能"><a href="#ZooKeeper-性能" class="headerlink" title="ZooKeeper 性能"></a>ZooKeeper 性能</h4><ul>
<li>ZooKeeper 将数据保存在内存中，这也就保证了 高吞吐量和低延迟（但是内存限制了能够存储的容量不太大，此限制也是保持znode中存储的数据量较小的进一步原因）。</li>
<li>ZooKeeper 是高性能的。 在“读”多于“写”的应用程序中尤其地高性能，因为“写”会导致所有的服务器间同步状态。（“读”多于“写”是协调服务的典型场景。）</li>
</ul>
<h4 id="Zookeeper-节点类型"><a href="#Zookeeper-节点类型" class="headerlink" title="Zookeeper 节点类型"></a>Zookeeper 节点类型</h4><ul>
<li>PERSISTENT 持久节点<ul>
<li>创建之后一直存在，除非有删除操作，创建节点的客户端会话失效也不影响此节点。</li>
</ul>
</li>
<li>PERSISTENT_SEQUENTIAL 持久顺序节点<ul>
<li>跟持久一样，就是父节点在创建下一级子节点的时候，记录每个子节点创建的先后顺序，会给每个子节点名加上一个数字后缀。</li>
</ul>
</li>
<li>EPHEMERAL 临时节点<ul>
<li>创建客户端会话失效（注意是会话失效，不是连接断了），节点也就没了。不能建子节点。</li>
</ul>
</li>
<li>EPHEMERAL_SEQUENTIAL 临时顺序节点<ul>
<li>基本特性同临时节点，增加了顺序属性，节点名后边会追加一个由父节点维护的自增整型数字。</li>
</ul>
</li>
</ul>
<h4 id="Zookeeper是如何保证事务的顺序一致性的"><a href="#Zookeeper是如何保证事务的顺序一致性的" class="headerlink" title="Zookeeper是如何保证事务的顺序一致性的"></a>Zookeeper是如何保证事务的顺序一致性的</h4><ul>
<li><p>Zookeeper采用了递增的事务Id来标识，所有的proposal都在被提出的时候加上了zxid，zxid实际上是一个64位的数字，高32位是epoch用来标识leader是否发生改变，如果有新的leader产生出来，epoch会自增，低32位用来递增计数。</p>
</li>
<li><p>当新产生proposal的时候，会依据数据库的两阶段过程，首先会向其他的server发出事务执行请求，如果超过半数的机器都能执行并且能够成功，那么就会开始执行</p>
</li>
</ul>
<h4 id="Zookeeper-的-Java-客户端都有哪些？"><a href="#Zookeeper-的-Java-客户端都有哪些？" class="headerlink" title="Zookeeper 的 Java 客户端都有哪些？"></a>Zookeeper 的 Java 客户端都有哪些？</h4><ul>
<li>Zookeeper 自带的 zkclient</li>
<li>Apache 开源的 Curator</li>
</ul>
<h4 id="客户端监控软件ZooInspector"><a href="#客户端监控软件ZooInspector" class="headerlink" title="客户端监控软件ZooInspector"></a>客户端监控软件ZooInspector</h4><ul>
<li><p>下载地址 <a href="https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip" target="_blank" rel="noopener">https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip</a></p>
</li>
<li><p>百度网盘地址：<a href="http://pan.baidu.com/s/1jH8MxRC" target="_blank" rel="noopener">http://pan.baidu.com/s/1jH8MxRC</a></p>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p><code>Zookeeper</code>这个动物园管理员我们可以简单的理解就是一个文件数据库仓库，大家可以在我这边存放数据，来取数据，同时提供了通知机制：提供者发生了变动， Zookeeper 会向订阅的消费者发送通知。</p>
</li>
<li><p>利用上面的特性，所以在分布式系统中，使用<code>Zookeeper</code>作为一个注册中心来是很方便有效的</p>
</li>
<li><p><code>Zookeeper</code>集群使用<code>CP</code>来保证数据的一致性</p>
</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li>芋道源码 <a href="http://www.iocoder.cn" target="_blank" rel="noopener">http://www.iocoder.cn</a></li>
<li><a href="https://snailclimb.gitee.io/javaguide/#/docs/system-design/framework/ZooKeeper" target="_blank" rel="noopener">https://snailclimb.gitee.io/javaguide/#/docs/system-design/framework/ZooKeeper</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    <footer>
        <a href="http://www.songshuiyang.com">
            <img src="/img/avatar.jpg" alt="songshuiyang">
            songshuiyang
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Zookeeper/">Zookeeper</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分布式/">分布式</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/&title=《分布式-Zookeeper-分布式协调服务-简介》 — 宋水阳个人博客&pic=http://www.songshuiyang.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/&title=《分布式-Zookeeper-分布式协调服务-简介》 — 宋水阳个人博客&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《分布式-Zookeeper-分布式协调服务-简介》 — 宋水阳个人博客&url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/&via=http://www.songshuiyang.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-Eureka与Zookeeper/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">分布式-Zookeeper-Eureka与Zookeeper</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/03/01/backend/distributed/分布式-限流算法/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">分布式-限流算法</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "cOdgshzpM38eAScO4B50lpML-gzGzoHsz",
            appKey: "yNmbxCmHmD0IXElWkbpImpzl",
            avatar: "robohash",
            placeholder: "少侠不吐槽吐槽?",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->










</article>



</div>

        <footer class="footer">
    <div class="bottom">
        <p><span>songshuiyang &copy; 2017 - 2023</span>
            <span>
                
                <a href="http://beian.miit.gov.cn" target="_blank">赣ICP备18001541号</a><br>
                
            </span>
            <span id="busuanzi_container_site_pv">
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/&title=《分布式-Zookeeper-分布式协调服务-简介》 — 宋水阳个人博客&pic=http://www.songshuiyang.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/&title=《分布式-Zookeeper-分布式协调服务-简介》 — 宋水阳个人博客&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《分布式-Zookeeper-分布式协调服务-简介》 — 宋水阳个人博客&url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/&via=http://www.songshuiyang.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.songshuiyang.com/2018/03/02/backend/distributed/zookeeper/分布式-Zookeeper-分布式协调服务-简介/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAAD/ElEQVR42u3ay2ojMRAF0Pz/T3u2A8HWvVVqksDpVXDilnQ0UFOPr6/4ef33fP/83c/vnu9//26Vd9/9vMq79197cODAgQNHfNTk1bOjfl798yefr+TzDvM948CBAweOuxzJAp8R863nYTIPrglHchk4cODAgeOnOBKaPGzPLiD5exw4cODA8Zs5kiQqP3yS1LVr4cCBAweO38NxN6FKSnubQuRm/9dqpThw4MCB41yvq4PfX/n5kfkOHDhw4MARN37aoJW/rU35ZmMQr9GDAwcOHDj2HJtRubuNq1n5b1ZMPODiwIEDB44FRxsC21CXjCa0wbUdeiiGIXDgwIEDx5ojD1ez7W7SrbaCFw0r5KfDgQMHDhwjjnxkYfPJLDlM/hOQpGd5AMaBAwcOHE9w5KW0up1TJn5ta2o2hHcItDhw4MCBo+QogtBibC5Pvdo3z1Y8BGYcOHDgwLHmmJX5NsG4LTi2zao8wEcoOHDgwIEj5mjb/+3B2hCeD1W0+4n+LeDAgQMHjjVH/oW2UTQbNWjH4za7OlwnDhw4cOBYcLTBbBb28tGENjS2AftwYThw4MCBY8GRFNHyJdthgrYFtb+Yw7lw4MCBA8cljjzUtcW4zTv3Fby6YYYDBw4cOC5xDBszcSGvPfDmAlYpHw4cOHDguMSRp0NtK6htCCXFxLaZVCRyOHDgwIHjEsfTgwuzIYm8TXVr3AEHDhw4cOw52gQs2cSt9GwW/vOM7JDU4cCBAweOSzlLe6RbhcUkACfVvLw4eGg74cCBAweOdd8/D2D553lqtykFtiN0EQoOHDhw4BhxtIW2ffp0q3U0G6o7XBsOHDhw4HiAY9Y6yoNxzpS3oJLf1l04HDhw4MCx4Gi3OCvb5Sj5Wm3gjwItDhw4cOBYcCS/bgtwebkwn7nIx/LaxtihVooDBw4cOEqOTfNmFiDzVC0fTWiHKuoUDgcOHDhwlN+ahc+25ZOnYfk4QksfnQ4HDhw4cKw58oDUbjEvHc6G6toBu9XOceDAgQNHwJEXBDdjCu3QQxvCr9HgwIEDB45LHO1IWTvK0G6rbYAlq0cBGwcOHDhwXOLYJFqzNtKtMbs2mSzG43DgwIEDx4jjWktmVPibJWl333wYaMCBAwcOHCXHq3zaeLRPC/OksQ3YxU3iwIEDB45tDBqmVZv2VVsQbIfn8lQTBw4cOHDsOfLFkuXbUt0eq93PIUjjwIEDB45LHHlhrm0OtalUvu4jWRgOHDhw4PhRjltYt8YpErgDJQ4cOHDg+CGOfOygXast57VX9UgKhwMHDhw4FsXBWRFwVihMoPORi+i7OHDgwIFjzZGX0toAmRTm8hXbw7TBGAcOHDhwrDn+AVR396py77GYAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


lazyScripts.push('//s95.cnzz.com/z_stat.php?id=1275444015&web_id=1275444015')

</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '老铁为何离开了';
            clearTimeout(titleTime);
        } else {
            document.title = '欢迎回来';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ac93934d9b847216e10a2f133187e535";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
